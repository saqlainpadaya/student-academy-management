<!DOCTYPE html>
<html>
<head>
  <title>Student Login</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
</head>
<body class="container mt-5">
  <h2>Student Login</h2>
  <input type="email" id="email" class="form-control" placeholder="Enter email">
  <br>
   <input type="password" id="password" class="form-control" placeholder="Enter password">
   <input type="checkbox" onclick="myFunction()">Show Password
   <br>
  <button onclick="checkpassword()" class="btn btn-primary mt-2">Login</button>
  <script>
    function checkpassword(){
        const email = document.getElementById('email').value;
        const password=document.getElementById('password').value;
        sessionStorage.setItem('email', email);
        sessionStorage.setItem('password', password);
        fetch('http://localhost:3000/api/pass', {
        method: 'POST',
        headers: {'Content-Type': 'application/json'},
        body: JSON.stringify({ email,password })
      })
       .then(res => res.json())
      .then(response => {
        if (response.success && response.type == "student") {
          //student_login(); 
          sessionStorage.setItem('student_id', response.student_id);
          window.location.href = 'dashboard.html';
        } else if(response.success && response.type == "teacher"){
            //teacher_login();
            sessionStorage.setItem('teacher_id', response.teacher_id);
            window.location.href = 'teacherdashboard.html';
        }
        else {
          alert(response.message || 'Password OR Email Incorrect');
        }
      })
      .catch(() => alert("Password OR Email Incorrect"));
    }

    function teacher_login(){
       const email = document.getElementById('email').value;
      fetch('http://localhost:3000/api/Tlogin', {
        method: 'POST',
        headers: {'Content-Type': 'application/json'},
        body: JSON.stringify({ email })
      })
      .then(res => res.json())
      .then(teacher => {
        sessionStorage.setItem('teacher_id', teacher.teacher_id);
        window.location.href = 'teacherdashboard.html';
      })
      .catch(() => alert("Login failed"));
    }

    function student_login() {
      const email = document.getElementById('email').value;
      fetch('http://localhost:3000/api/login', {
        method: 'POST',
        headers: {'Content-Type': 'application/json'},
        body: JSON.stringify({ email })
      })
      .then(res => res.json())
      .then(student => {
        sessionStorage.setItem('student_id', student.student_id);
        window.location.href = 'dashboard.html';
      })
      .catch(() => alert("Login failed"));
    }
 function myFunction() {
        var x = document.getElementById("password");
        if (x.type === "password") {
            x.type = "text";
        } else {
            x.type = "password";
        }
        }
  </script>
</body>
</html>
